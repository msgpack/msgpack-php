# autogenerated file; do not edit
language: c

addons:
 apt:
  packages:
   - php-cli
   - php-pear

env:
 matrix:
  - PHP=7.0 enable_debug=yes enable_maintainer_zts=yes enable_json=yes
  - PHP=7.1 enable_debug=yes enable_maintainer_zts=yes enable_json=yes
  - PHP=7.2 enable_debug=yes enable_maintainer_zts=yes enable_json=yes
  - PHP=7.3 enable_debug=yes enable_maintainer_zts=yes enable_json=yes
  - PHP=7.4 enable_debug=yes enable_maintainer_zts=yes enable_json=yes
  - PHP=master enable_debug=yes enable_zts=yes enable_json=yes
  - PHP=8.0 enable_debug=no enable_zts=no enable_json=yes
  - PHP=8.0 enable_debug=yes enable_zts=no enable_json=yes
  - PHP=8.0 enable_debug=no enable_zts=yes enable_json=yes
  - PHP=8.0 enable_debug=yes enable_zts=yes enable_json=yes
  - CFLAGS='-O0 -g --coverage' CXXFLAGS='-O0 -g --coverage' PHP=8.0 enable_json=yes

cache:
 directories:
  - $HOME/cache

before_cache:
 - find $HOME/cache -name '*.gcda' -o -name '*.gcno' -delete

install:
 - make -f travis/pecl/Makefile php

script:
 - make -f travis/pecl/Makefile ext PECL=msgpack
 - make -f travis/pecl/Makefile test

after_success:
 - test -n "$CFLAGS" && cd .libs && bash <(curl -s https://codecov.io/bash) -X xcode -X coveragepy
